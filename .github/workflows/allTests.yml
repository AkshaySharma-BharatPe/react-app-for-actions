name: 'Lighthouse'

on: [pull_request]

jobs:  
  assets-check:
    name: Assets Checker
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@master
      - uses: actions/setup-node@v1
        with:
            node-version: '16.16.0'

      - uses: bharatpe/assets-checker@main
        with:
            token: ${{ secrets.GITHUB_TOKEN }}
            target_folder: src/assets
            thrashold_size: 10000

  Calculate-Bundle-Difference:
    name: Bundle size Check
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@master
      # - uses: webfactory/ssh-agent@v0.5.4
      #   with:
      #       ssh-private-key: ${{ secrets.SSH_PRIVATE_KEY }}
      - uses: actions/setup-node@v1
        with:
            node-version: '16.16.0'
      - uses: bharatpe/pr-bundle-analyzer@main
        with:
            install_command: 'yarn install'
            build_command: 'yarn run build'
            build_path: 'build/static'
            base_branch: ${{ github.base_ref }}
            head_branch: ${{ github.head_ref }}
            token: ${{ secrets.GITHUB_TOKEN }} 